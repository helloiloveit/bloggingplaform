{{extend 'layout.html'}}
<style>
#suggestions { position: relative; }
.suggestions { background: white; border: solid 1px #55A6C8; }
.suggestions DIV { padding: 2px 4px 2px 4px; }
</style>


<div class="post_article">
  <div>
    <!-- end #header --></div>
  <div id="mainContent">
    <h1>  </h1>

    <form id ="question_content_form" action="post_question" method="post">
         <p>




        <!--
        <select name="article_class" >
        {{for article in article_tag_list:}}
        <option value="{{=article.name}}">{{=article.name}}</option>
        {{pass}}
        </select>
        -->
        </p>
        <p>
            <input id ="tag_list" type ="hidden"  type="text" name="tag_list"  autocomplete="off" value = tag_list>
           <input id = "question_header" type="text" name="question_info" value = "bất cứ thứ gì bạn muốn hiểu:
           ">
        </p>
        <!--
        <p>
            <textarea class="ckeditor" cols="80" id="editor1" name="editor1" rows="10">

            </textarea>
        </p>-->
        <p>
                <textarea  id="editor1" name="editor1" rows="10" >

            </textarea>
        </p>
    </form>
      <form>
          <input type="text" id="month" name="tag_info" value = "input tag here" autocomplete="off" style="width: 250px" />
          <br />
          <div style="position: absolute;" id="suggestions" class="suggestions">
          </div>
      </form>
      <div id="target"></div>
      <button id="post_question_button"> post question </button>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <h2></h2>
    <p></p>
    <!-- end #mainContent --></div>
  <!-- end #footer --></div>
<!-- end #container --></div>

    <script>
        var tag_list = [];

        function test(){
        alert('test');
        }
        jQuery("#month").keyup(function(){
            ajax('tag_handler', ['tag_info'], 'suggestions');
            });
        jQuery("#month").click(function(){
            $("#month").val("");
            });

        jQuery("#post_question_button").click(function(){
            $( "#question_content_form" ).submit();
            });
        jQuery("#target").on('click', 'span.delete-tag', function() {
            alert(tag_list);
            alert('delete' + $(this).attr('value'));
            //remove tag from tag list
            removeItem = $(this).attr('value');
            tag_list = jQuery.grep(tag_list, function(value) {
            return value != removeItem;
            });
            alert(tag_list);
            alert($(this).parent().attr('class'));
            $(this).parent().remove();
            });


      function user_post_new_tag(tag_info, suggestion_box_id){
         $("#" + suggestion_box_id).remove();
         var request = $.ajax({
                url: "http://localhost:8002/welcome/default/create_new_tag",
                type: "POST",
                data: { tag_info  : tag_info },
                dataType: "html"
          });


        request.done(function( msg ) {
            user_select_tag_handler(tag_info, 'suggestion_box');
        });

        request.fail(function( jqXHR, textStatus ) {
            alert( "Request failed: " + textStatus );
        });

      }

      function user_select_tag_handler(tag_info, suggestion_box_id){
         //$('#month').val(tag_info);
         $("#" + suggestion_box_id).remove();

         current_tag = $('#target').html();
         //$('#target').html(current_tag+' ' + tag_info);
         alert(tag_info + tag_list);

         if ($.inArray(tag_info, tag_list) == -1)
        {
            tag_list[tag_list.length] = tag_info;
            alert(tag_info);
            var txt1 = "<span class = post-tag>" + tag_info + "<span id = delete_tag value = "+ tag_info + " class = delete-tag title = remove this tag>x</span></span>";
            $('#target').append(txt1);
         }

         $('#tag_list').val(tag_list);

      }

    </script>


</html>


